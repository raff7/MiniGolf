(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function r(t){return"function"==typeof t}function n(t){return"object"==typeof t&&null!==t}function e(){}function o(t,r){for(var n=0,e=t.length;e>n;n++)if(t[n]===r)return n;return-1}function i(t){var r=t._promiseCallbacks;return r||(r=t._promiseCallbacks={}),r}function u(t,r){return"onerror"===t?void bt.on("error",r):2!==arguments.length?bt[t]:void(bt[t]=r)}function a(){setTimeout(function(){for(var t,r=0;r<Et.length;r++){t=Et[r];var n=t.payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),bt.trigger(t.name,t.payload)}Et.length=0},50)}function c(t,r,n){1===Et.push({name:t,payload:{key:r._guidKey,id:r._id,eventName:t,detail:r._result,childId:n&&n._id,label:r._label,timeStamp:mt(),error:bt["instrument-with-stack"]?new Error(r._label):null}})&&a()}function s(){return new TypeError("A promises callback cannot return that same promise.")}function f(){}function l(t){try{return t.then}catch(t){return kt.error=t,kt}}function p(t,r,n,e){try{t.call(r,n,e)}catch(t){return t}}function h(t,r,n){bt.async(function(t){var e=!1,o=p(n,r,function(n){e||(e=!0,r!==n?d(t,n):m(t,n))},function(r){e||(e=!0,g(t,r))},"Settle: "+(t._label||" unknown promise"));!e&&o&&(e=!0,g(t,o))},t)}function _(t,r){r._state===Tt?m(t,r._result):r._state===St?(r._onError=null,g(t,r._result)):w(r,void 0,function(n){r!==n?d(t,n):m(t,n)},function(r){g(t,r)})}function v(t,n){if(n.constructor===t.constructor)_(t,n);else{var e=l(n);e===kt?g(t,kt.error):void 0===e?m(t,n):r(e)?h(t,n,e):m(t,n)}}function d(r,n){r===n?m(r,n):t(n)?v(r,n):m(r,n)}function y(t){t._onError&&t._onError(t._result),b(t)}function m(t,r){t._state===jt&&(t._result=r,t._state=Tt,0===t._subscribers.length?bt.instrument&&At("fulfilled",t):bt.async(b,t))}function g(t,r){t._state===jt&&(t._state=St,t._result=r,bt.async(y,t))}function w(t,r,n,e){var o=t._subscribers,i=o.length;t._onError=null,o[i]=r,o[i+Tt]=n,o[i+St]=e,0===i&&t._state&&bt.async(b,t)}function b(t){var r=t._subscribers,n=t._state;if(bt.instrument&&At(n===Tt?"fulfilled":"rejected",t),0!==r.length){for(var e,o,i=t._result,u=0;u<r.length;u+=3)e=r[u],o=r[u+n],e?j(n,e,o,i):o(i);t._subscribers.length=0}}function E(){this.error=null}function A(t,r){try{return t(r)}catch(t){return Ct.error=t,Ct}}function j(t,n,e,o){var i,u,a,c,f=r(e);if(f){if(i=A(e,o),i===Ct?(c=!0,u=i.error,i=null):a=!0,n===i)return void g(n,s())}else i=o,a=!0;n._state!==jt||(f&&a?d(n,i):c?g(n,u):t===Tt?m(n,i):t===St&&g(n,i))}function T(t,r){var n=!1;try{r(function(r){n||(n=!0,d(t,r))},function(r){n||(n=!0,g(t,r))})}catch(r){g(t,r)}}function S(t,r,n){return t===Tt?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function k(t,r,n,e){var o=this;o._instanceConstructor=t,o.promise=new t(f,e),o._abortOnReject=n,o._validateInput(r)?(o._input=r,o.length=r.length,o._remaining=r.length,o._init(),0===o.length?m(o.promise,o._result):(o.length=o.length||0,o._enumerate(),0===o._remaining&&m(o.promise,o._result))):g(o.promise,o._validationError())}function C(t,r){return new Ot(this,t,!0,r).promise}function O(t,r){function n(t){d(i,t)}function e(t){g(i,t)}var o=this,i=new o(f,r);if(!yt(t))return g(i,new TypeError("You must pass an array to race.")),i;for(var u=t.length,a=0;i._state===jt&&u>a;a++)w(o.resolve(t[a]),void 0,n,e);return i}function I(t,r){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var e=new n(f,r);return d(e,t),e}function R(t,r){var n=this,e=new n(f,r);return g(e,t),e}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function x(t,n){var e=this;e._id=Nt++,e._label=n,e._state=void 0,e._result=void 0,e._subscribers=[],bt.instrument&&At("created",e),f!==t&&(r(t)||M(),e instanceof x||P(),T(e,t))}function N(t,r,n){this._superConstructor(t,r,!1,n)}function Y(t,r){return new N(Yt,t,r).promise}function D(t,r){return Yt.all(t,r)}function K(t,r){Bt[Ft]=t,Bt[Ft+1]=r,Ft+=2,2===Ft&&Kt()}function U(){var t=process.nextTick,r=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(r)&&"0"===r[1]&&"10"===r[2]&&(t=setImmediate),function(){t(V)}}function q(){return function(){Dt(V)}}function F(){var t=0,r=new Wt(V),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function G(){var t=new MessageChannel;return t.port1.onmessage=V,function(){t.port2.postMessage(0)}}function L(){return function(){setTimeout(V,1)}}function V(){for(var t=0;Ft>t;t+=2){var r=Bt[t],n=Bt[t+1];r(n),Bt[t]=void 0,Bt[t+1]=void 0}Ft=0}function W(){try{var t=require,r=t("vertx");return Dt=r.runOnLoop||r.runOnContext,q()}catch(t){return L()}}function $(t){var r={};return r.promise=new Yt(function(t,n){r.resolve=t,r.reject=n},t),r}function z(t,n,e){return Yt.all(t,e).then(function(t){if(!r(n))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,i=new Array(o),u=0;o>u;u++)i[u]=n(t[u]);return Yt.all(i,e).then(function(r){for(var n=new Array(o),e=0,i=0;o>i;i++)r[i]&&(n[e]=t[i],e++);return n.length=e,n})})}function B(t,r,n){this._superConstructor(t,r,!0,n)}function H(t,r,n){this._superConstructor(t,r,!1,n)}function J(t,r){return new H(Yt,t,r).promise}function Q(t,r){return new Qt(Yt,t,r).promise}function X(t,n,e){return Yt.all(t,e).then(function(t){if(!r(n))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,i=new Array(o),u=0;o>u;u++)i[u]=n(t[u]);return Yt.all(i,e)})}function Z(){this.value=void 0}function tt(t){try{return t.then}catch(t){return nr.value=t,nr}}function rt(t,r,n){try{t.apply(r,n)}catch(t){return nr.value=t,nr}}function nt(t,r){for(var n,e,o={},i=t.length,u=new Array(i),a=0;i>a;a++)u[a]=t[a];for(e=0;e<r.length;e++)n=r[e],o[n]=u[e+1];return o}function et(t){for(var r=t.length,n=new Array(r-1),e=1;r>e;e++)n[e-1]=t[e];return n}function ot(t,r){return{then:function(n,e){return t.call(r,n,e)}}}function it(t,r){var n=function(){for(var n,e=this,o=arguments.length,i=new Array(o+1),u=!1,a=0;o>a;++a){if(n=arguments[a],!u){if(u=ct(n),u===er){var c=new Yt(f);return g(c,er.value),c}u&&u!==!0&&(n=ot(u,n))}i[a]=n}var s=new Yt(f);return i[o]=function(t,n){t?g(s,t):void 0===r?d(s,n):r===!0?d(s,et(arguments)):yt(r)?d(s,nt(arguments,r)):d(s,n)},u?at(s,i,t,e):ut(s,i,t,e)};return n.__proto__=t,n}function ut(t,r,n,e){var o=rt(n,e,r);return o===nr&&g(t,o.value),t}function at(t,r,n,e){return Yt.all(r).then(function(r){var o=rt(n,e,r);return o===nr&&g(t,o.value),t})}function ct(t){return t&&"object"==typeof t?t.constructor===Yt?!0:tt(t):!1}function st(t,r){return Yt.race(t,r)}function ft(t,r){return Yt.reject(t,r)}function lt(t,r){return Yt.resolve(t,r)}function pt(t){throw setTimeout(function(){throw t}),t}function ht(t,r){bt.async(t,r)}function _t(){bt.on.apply(bt,arguments)}function vt(){bt.off.apply(bt,arguments)}var dt;dt=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var yt=dt,mt=Date.now||function(){return(new Date).getTime()},gt=Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return e.prototype=t,new e},wt={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,r){var n,e=i(this);n=e[t],n||(n=e[t]=[]),-1===o(n,r)&&n.push(r)},off:function(t,r){var n,e,u=i(this);return r?(n=u[t],e=o(n,r),void(-1!==e&&n.splice(e,1))):void(u[t]=[])},trigger:function(t,r){var n,e,o=i(this);if(n=o[t])for(var u=0;u<n.length;u++)(e=n[u])(r)}},bt={instrument:!1};wt.mixin(bt);var Et=[],At=c,jt=void 0,Tt=1,St=2,kt=new E,Ct=new E,Ot=k;k.prototype._validateInput=function(t){return yt(t)},k.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},k.prototype._init=function(){this._result=new Array(this.length)},k.prototype._enumerate=function(){for(var t=this,r=t.length,n=t.promise,e=t._input,o=0;n._state===jt&&r>o;o++)t._eachEntry(e[o],o)},k.prototype._eachEntry=function(t,r){var e=this,o=e._instanceConstructor;n(t)?t.constructor===o&&t._state!==jt?(t._onError=null,e._settledAt(t._state,r,t._result)):e._willSettleAt(o.resolve(t),r):(e._remaining--,e._result[r]=e._makeResult(Tt,r,t))},k.prototype._settledAt=function(t,r,n){var e=this,o=e.promise;o._state===jt&&(e._remaining--,e._abortOnReject&&t===St?g(o,n):e._result[r]=e._makeResult(t,r,n)),0===e._remaining&&m(o,e._result)},k.prototype._makeResult=function(t,r,n){return n},k.prototype._willSettleAt=function(t,r){var n=this;w(t,void 0,function(t){n._settledAt(Tt,r,t)},function(t){n._settledAt(St,r,t)})};var It=C,Rt=O,Mt=I,Pt=R,xt="rsvp_"+mt()+"-",Nt=0,Yt=x;x.cast=Mt,x.all=It,x.race=Rt,x.resolve=Mt,x.reject=Pt,x.prototype={constructor:x,_guidKey:xt,_onError:function(t){bt.async(function(r){setTimeout(function(){r._onError&&bt.trigger("error",t)},0)},this)},then:function(t,r,n){var e=this,o=e._state;if(o===Tt&&!t||o===St&&!r)return bt.instrument&&At("chained",e,e),e;e._onError=null;var i=new e.constructor(f,n),u=e._result;if(bt.instrument&&At("chained",e,i),o){var a=arguments[o-1];bt.async(function(){j(o,i,a,u)})}else w(e,i,t,r);return i},catch:function(t,r){return this.then(void 0,t,r)},finally:function(t,r){var n=this,e=n.constructor;return n.then(function(r){return e.resolve(t()).then(function(){return r})},function(r){return e.resolve(t()).then(function(){throw r})},r)}},N.prototype=gt(Ot.prototype),N.prototype._superConstructor=Ot,N.prototype._makeResult=S,N.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Dt,Kt,Ut=Y,qt=D,Ft=0,Gt=({}.toString,K),Lt="undefined"!=typeof window?window:void 0,Vt=Lt||{},Wt=Vt.MutationObserver||Vt.WebKitMutationObserver,$t="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),zt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Bt=new Array(1e3);Kt=$t?U():Wt?F():zt?G():void 0===Lt&&"function"==typeof require?W():L();var Ht=$,Jt=z,Qt=B;B.prototype=gt(Ot.prototype),B.prototype._superConstructor=Ot,B.prototype._init=function(){this._result={}},B.prototype._validateInput=function(t){return t&&"object"==typeof t},B.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},B.prototype._enumerate=function(){var t=this,r=t.promise,n=t._input,e=[];for(var o in n)r._state===jt&&Object.prototype.hasOwnProperty.call(n,o)&&e.push({position:o,entry:n[o]});var i=e.length;t._remaining=i;for(var u,a=0;r._state===jt&&i>a;a++)u=e[a],t._eachEntry(u.entry,u.position)},H.prototype=gt(Qt.prototype),H.prototype._superConstructor=Ot,H.prototype._makeResult=S,H.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var Xt,Zt=J,tr=Q,rr=X,nr=new Z,er=new Z,or=it;if("object"==typeof self)Xt=self;else{if("object"!=typeof global)throw new Error("no global: `self` or `global` found");Xt=global}var ir=Xt,ur=st,ar=ft,cr=lt,sr=pt;bt.async=Gt;if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var fr=window.__PROMISE_INSTRUMENTATION__;u("instrument",!0);for(var lr in fr)fr.hasOwnProperty(lr)&&_t(lr,fr[lr])}var pr={race:ur,Promise:Yt,allSettled:Ut,hash:tr,hashSettled:Zt,denodeify:or,on:_t,off:vt,map:rr,filter:Jt,resolve:cr,reject:ar,all:qt,rethrow:sr,defer:Ht,EventTarget:wt,configure:u,async:ht};"function"==typeof define&&define.amd?define(function(){return pr}):"undefined"!=typeof module&&module.exports?module.exports=pr:"undefined"!=typeof ir&&(ir.RSVP=pr)}).call(this);